<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - RideWithNandaa</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <style>
        :root {
            --black: #000000;
            --white: #FFFFFF;
            --gray: #808080;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Outfit', sans-serif;
            color: var(--white);
            background: var(--black);
        }
        
        /* Sidebar */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            bottom: 0;
            width: 280px;
            background: var(--black);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            padding: 2rem 0;
            overflow-y: auto;
        }
        
        .sidebar-brand {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            font-weight: 700;
            padding: 0 2rem;
            margin-bottom: 3rem;
        }
        
        .sidebar-nav {
            list-style: none;
            padding: 0;
        }
        
        .nav-item {
            margin-bottom: 0.5rem;
        }
        
        .nav-link {
            display: block;
            padding: 0.8rem 2rem;
            color: var(--white);
            text-decoration: none;
            opacity: 0.7;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }
        
        .nav-link:hover,
        .nav-link.active {
            opacity: 1;
            border-left-color: var(--white);
            background: rgba(255, 255, 255, 0.05);
        }
        
        .nav-link i {
            margin-right: 0.8rem;
            width: 20px;
        }
        
        /* Main Content */
        .main-content {
            margin-left: 280px;
            padding: 2rem;
            min-height: 100vh;
        }
        
        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 3rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .page-title {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            font-weight: 700;
        }
        
        .admin-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .btn-logout {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: var(--white);
            padding: 0.5rem 1.5rem;
            border-radius: 0;
            font-weight: 500;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.85rem;
        }
        
        .btn-logout:hover {
            border-color: var(--white);
            color: var(--white);
        }
        
        /* Cards */
        .stat-card {
            background: var(--black);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 2rem;
            margin-bottom: 1.5rem;
        }
        
        .stat-label {
            opacity: 0.7;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            font-family: 'Playfair Display', serif;
        }
        
        /* Content Section */
        .content-section {
            display: none;
        }
        
        .content-section.active {
            display: block;
        }
        
        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 2rem;
        }
        
        /* Forms */
        .form-label {
            color: var(--white);
            margin-bottom: 0.5rem;
            font-weight: 500;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 1px;
        }
        
        .form-control, .form-select {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: var(--white);
            padding: 0.8rem;
            border-radius: 0;
            margin-bottom: 1.5rem;
        }
        
        .form-control:focus, .form-select:focus {
            background: transparent;
            border-color: var(--white);
            color: var(--white);
            box-shadow: none;
        }
        
        .form-control::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        .form-select option {
            background: var(--black);
            color: var(--white);
        }
        
        textarea.form-control {
            min-height: 150px;
        }
        
        .btn-primary {
            background: var(--white);
            border: 1px solid var(--white);
            color: var(--black);
            padding: 0.7rem 2rem;
            border-radius: 0;
            font-weight: 500;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.9rem;
        }
        
        .btn-primary:hover {
            background: var(--black);
            color: var(--white);
        }
        
        .btn-secondary {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: var(--white);
            padding: 0.7rem 2rem;
            border-radius: 0;
            font-weight: 500;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.9rem;
        }
        
        .btn-secondary:hover {
            border-color: var(--white);
            color: var(--white);
        }
        
        .btn-danger {
            background: transparent;
            border: 1px solid #dc3545;
            color: #dc3545;
            padding: 0.5rem 1rem;
            border-radius: 0;
            font-weight: 500;
            transition: all 0.3s ease;
            font-size: 0.85rem;
        }
        
        .btn-danger:hover {
            background: #dc3545;
            color: var(--white);
        }
        
        /* Tables */
        .table {
            color: var(--white);
            border-color: rgba(255, 255, 255, 0.1);
        }
        
        .table thead {
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .table th {
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 1px;
            font-weight: 600;
            padding: 1rem;
            border-color: rgba(255, 255, 255, 0.1);
        }
        
        .table td {
            padding: 1rem;
            border-color: rgba(255, 255, 255, 0.1);
        }
        
        .alert {
            border-radius: 0;
            border: 1px solid;
            background: transparent;
            margin-bottom: 1.5rem;
        }
        
        .alert-success {
            border-color: #28a745;
            color: #28a745;
        }
        
        .alert-danger {
            border-color: #dc3545;
            color: #dc3545;
        }
        
        .badge {
            padding: 0.5rem 1rem;
            border-radius: 0;
            font-weight: 500;
            text-transform: uppercase;
            font-size: 0.75rem;
            letter-spacing: 1px;
        }
        
        .badge-super {
            background: var(--white);
            color: var(--black);
        }
        
        .badge-admin {
            background: transparent;
            border: 1px solid var(--white);
            color: var(--white);
        }
        
        /* Mobile */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                position: relative;
                border-right: none;
                border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            }
            
            .main-content {
                margin-left: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-brand">RideWithNandaa</div>
        <ul class="sidebar-nav">
            <li class="nav-item">
                <a href="#" class="nav-link active" data-section="dashboard">
                    <i class="fas fa-home"></i>Dashboard
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" data-section="content">
                    <i class="fas fa-edit"></i>Edit Content
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" data-section="contact">
                    <i class="fas fa-address-book"></i>Contact Info
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" data-section="services">
                    <i class="fas fa-concierge-bell"></i>Services
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" data-section="fleet">
                    <i class="fas fa-car"></i>Fleet
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" data-section="users" id="usersNavLink">
                    <i class="fas fa-users"></i>Admin Users
                </a>
            </li>
        </ul>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="top-bar">
            <h1 class="page-title">Dashboard</h1>
            <div class="admin-info">
                <span id="currentUsername"></span>
                <button class="btn btn-logout" onclick="logout()">
                    <i class="fas fa-sign-out-alt me-2"></i>Logout
                </button>
            </div>
        </div>

        <!-- Dashboard Section -->
        <div id="dashboard" class="content-section active">
            <div class="row">
                <div class="col-lg-3 col-md-6">
                    <div class="stat-card">
                        <div class="stat-label">Total Bookings</div>
                        <div class="stat-value">0</div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="stat-card">
                        <div class="stat-label">Active Drivers</div>
                        <div class="stat-value">0</div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="stat-card">
                        <div class="stat-label">Happy Customers</div>
                        <div class="stat-value" id="statCustomers">2500+</div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="stat-card">
                        <div class="stat-label">Admin Users</div>
                        <div class="stat-value" id="statAdmins">0</div>
                    </div>
                </div>
            </div>
            
            <div class="stat-card mt-4">
                <h3 class="section-title">Quick Actions</h3>
                <div class="d-flex gap-3 flex-wrap">
                    <button class="btn btn-primary" onclick="showSection('content')">Edit Content</button>
                    <button class="btn btn-secondary" onclick="showSection('contact')">Update Contact</button>
                    <a href="index.html" target="_blank" class="btn btn-secondary">View Website</a>
                </div>
            </div>
        </div>

        <!-- Edit Content Section -->
        <div id="content" class="content-section">
            <div class="stat-card">
                <h3 class="section-title">Edit Website Content</h3>
                
                <div id="contentMessage"></div>
                
                <form id="contentForm">
                    <div class="row">
                        <div class="col-12">
                            <label class="form-label">Hero Title</label>
                            <input type="text" class="form-control" id="heroTitle" placeholder="Main headline">
                        </div>
                        
                        <div class="col-12">
                            <label class="form-label">Hero Subtitle</label>
                            <textarea class="form-control" id="heroSubtitle" rows="3"></textarea>
                        </div>
                        
                        <div class="col-12">
                            <label class="form-label">About Us - Company Story</label>
                            <textarea class="form-control" id="aboutStory" rows="5"></textarea>
                        </div>
                        
                        <div class="col-12">
                            <label class="form-label">Footer Description</label>
                            <textarea class="form-control" id="footerDesc" rows="3"></textarea>
                        </div>
                        
                        <div class="col-12">
                            <button type="submit" class="btn btn-primary me-2">Save Changes</button>
                            <button type="button" class="btn btn-secondary" onclick="loadContent()">Reset</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <!-- Contact Info Section -->
        <div id="contact" class="content-section">
            <div class="stat-card">
                <h3 class="section-title">Contact Information</h3>
                
                <div id="contactMessage"></div>
                
                <form id="contactForm">
                    <div class="row">
                        <div class="col-md-6">
                            <label class="form-label">Phone Number</label>
                            <input type="text" class="form-control" id="phone" placeholder="+91 99900 51602">
                        </div>
                        
                        <div class="col-md-6">
                            <label class="form-label">Email Address</label>
                            <input type="email" class="form-control" id="email" placeholder="ridewithnanda@gmail.com">
                        </div>
                        
                        <div class="col-md-6">
                            <label class="form-label">Instagram Handle</label>
                            <input type="text" class="form-control" id="instagram" placeholder="@ridewithnandaa">
                        </div>
                        
                        <div class="col-md-6">
                            <label class="form-label">WhatsApp Number</label>
                            <input type="text" class="form-control" id="whatsapp" placeholder="919990051602">
                        </div>
                        
                        <div class="col-12">
                            <button type="submit" class="btn btn-primary me-2">Save Changes</button>
                            <button type="button" class="btn btn-secondary" onclick="loadContactInfo()">Reset</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <!-- Services Section -->
        <div id="services" class="content-section">
            <div class="stat-card">
                <h3 class="section-title">Manage Services</h3>
                <p class="mb-4">Edit service titles and descriptions</p>
                
                <div id="servicesMessage"></div>
                
                <form id="servicesForm">
                    <div id="servicesContainer"></div>
                    
                    <button type="submit" class="btn btn-primary me-2">Save All Services</button>
                    <button type="button" class="btn btn-secondary" onclick="loadServices()">Reset</button>
                </form>
            </div>
        </div>

        <!-- Fleet Section -->
        <div id="fleet" class="content-section">
            <div class="stat-card">
                <h3 class="section-title">Manage Fleet</h3>
                <p class="mb-4">Edit vehicle information and pricing</p>
                
                <div id="fleetMessage"></div>
                
                <form id="fleetForm">
                    <div id="fleetContainer"></div>
                    
                    <button type="submit" class="btn btn-primary me-2">Save All Vehicles</button>
                    <button type="button" class="btn btn-secondary" onclick="loadFleet()">Reset</button>
                </form>
            </div>
        </div>

        <!-- Admin Users Section -->
        <div id="users" class="content-section">
            <div class="stat-card">
                <h3 class="section-title">Admin Users Management</h3>
                
                <div id="usersMessage"></div>
                
                <div class="mb-4">
                    <button class="btn btn-primary" onclick="showAddUserForm()">
                        <i class="fas fa-plus me-2"></i>Add New Admin
                    </button>
                </div>
                
                <!-- Add User Form -->
                <div id="addUserForm" style="display: none;" class="mb-4">
                    <h4 class="mb-3">Add New Admin User</h4>
                    <form id="newUserForm">
                        <div class="row">
                            <div class="col-md-4">
                                <label class="form-label">Username</label>
                                <input type="text" class="form-control" id="newUsername" required>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">Password</label>
                                <input type="password" class="form-control" id="newPassword" required>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">Role</label>
                                <select class="form-select" id="newRole" required>
                                    <option value="admin">Admin</option>
                                    <option value="super-admin">Super Admin</option>
                                </select>
                            </div>
                            <div class="col-12 mt-3">
                                <button type="submit" class="btn btn-primary me-2">Add User</button>
                                <button type="button" class="btn btn-secondary" onclick="hideAddUserForm()">Cancel</button>
                            </div>
                        </div>
                    </form>
                </div>
                
                <!-- Users Table -->
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Username</th>
                                <th>Role</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="usersTable"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Check authentication
        if (localStorage.getItem('adminLoggedIn') !== 'true') {
            window.location.href = 'admin-login.html';
        }
        
        // Get current admin
        const currentAdmin = JSON.parse(localStorage.getItem('currentAdmin') || '{}');
        document.getElementById('currentUsername').textContent = currentAdmin.username || 'Admin';
        
        // Hide users section if not super-admin
        if (currentAdmin.role !== 'super-admin') {
            document.getElementById('usersNavLink').style.display = 'none';
        }
        
        // Initialize data structures
        function initializeData() {
            if (!localStorage.getItem('siteContent')) {
                localStorage.setItem('siteContent', JSON.stringify({
                    heroTitle: 'Travel with Comfort.<br>Travel with Trust.',
                    heroSubtitle: 'Connecting travellers with verified local drivers for stress-free journeys from Delhi NCR to Uttarakhand and beyond.',
                    aboutStory: 'RideWithNandaa was born from a simple belief: travel should be stress-free, affordable, and personal. We started with a mission to connect travellers with verified local drivers who know the roads, understand the journey, and care about getting you there safely.',
                    footerDesc: 'Connecting travellers with verified local drivers for affordable, reliable rides. Making travel simple, personal, and stress-free.'
                }));
            }
            
            if (!localStorage.getItem('contactInfo')) {
                localStorage.setItem('contactInfo', JSON.stringify({
                    phone: '+91 99900 51602',
                    email: 'ridewithnanda@gmail.com',
                    instagram: '@ridewithnandaa',
                    whatsapp: '919990051602'
                }));
            }
            
            if (!localStorage.getItem('services')) {
                localStorage.setItem('services', JSON.stringify([
                    {
                        title: 'Outstation Rides',
                        description: 'Comfortable long-distance travel to Uttarakhand destinations including Nainital, Mussoorie, Rishikesh, and more.',
                        icon: 'fa-route'
                    },
                    {
                        title: 'Local Packages',
                        description: 'Explore cities and towns with our flexible hourly and daily local packages with verified drivers.',
                        icon: 'fa-city'
                    },
                    {
                        title: 'Airport Transfer',
                        description: 'Reliable and punctual airport pickup and drop services available 24/7 across Delhi NCR.',
                        icon: 'fa-plane-departure'
                    },
                    {
                        title: 'One-Way Trips',
                        description: 'Cost-effective one-way journeys without return charges for flexible travel plans.',
                        icon: 'fa-arrow-right'
                    },
                    {
                        title: 'Tour Packages',
                        description: 'Customized multi-day tour packages covering popular Himalayan destinations and hill stations.',
                        icon: 'fa-mountain'
                    },
                    {
                        title: 'Group Travel',
                        description: 'Spacious vehicles for family trips and group outings with professional drivers.',
                        icon: 'fa-users'
                    }
                ]));
            }
            
            if (!localStorage.getItem('fleet')) {
                localStorage.setItem('fleet', JSON.stringify([
                    {
                        name: 'Toyota Innova',
                        type: 'SUV • 6+1 Seater',
                        price: '₹14/km onwards'
                    },
                    {
                        name: 'Maruti Ertiga',
                        type: 'MUV • 6+1 Seater',
                        price: '₹12/km onwards'
                    },
                    {
                        name: 'Sedan Cars',
                        type: 'Sedan • 4+1 Seater',
                        price: '₹10/km onwards'
                    }
                ]));
            }
        }
        
        initializeData();
        
        // Update admin count
        const admins = JSON.parse(localStorage.getItem('admins') || '[]');
        document.getElementById('statAdmins').textContent = admins.length;
        
        // Navigation
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const section = this.dataset.section;
                
                if (section === 'users' && currentAdmin.role !== 'super-admin') {
                    return;
                }
                
                showSection(section);
            });
        });
        
        function showSection(sectionId) {
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            document.getElementById(sectionId).classList.add('active');
            document.querySelector(`[data-section="${sectionId}"]`).classList.add('active');
            
            // Update page title
            const titles = {
                dashboard: 'Dashboard',
                content: 'Edit Content',
                contact: 'Contact Information',
                services: 'Manage Services',
                fleet: 'Manage Fleet',
                users: 'Admin Users'
            };
            document.querySelector('.page-title').textContent = titles[sectionId] || 'Dashboard';
            
            // Load data for section
            if (sectionId === 'content') loadContent();
            if (sectionId === 'contact') loadContactInfo();
            if (sectionId === 'services') loadServices();
            if (sectionId === 'fleet') loadFleet();
            if (sectionId === 'users') loadUsers();
        }
        
        // Content Management
        function loadContent() {
            const content = JSON.parse(localStorage.getItem('siteContent'));
            document.getElementById('heroTitle').value = content.heroTitle.replace('<br>', ' ');
            document.getElementById('heroSubtitle').value = content.heroSubtitle;
            document.getElementById('aboutStory').value = content.aboutStory;
            document.getElementById('footerDesc').value = content.footerDesc;
        }
        
        document.getElementById('contentForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const content = {
                heroTitle: document.getElementById('heroTitle').value,
                heroSubtitle: document.getElementById('heroSubtitle').value,
                aboutStory: document.getElementById('aboutStory').value,
                footerDesc: document.getElementById('footerDesc').value
            };
            
            localStorage.setItem('siteContent', JSON.stringify(content));
            
            showMessage('contentMessage', 'Content updated successfully!', 'success');
        });
        
        // Contact Info Management
        function loadContactInfo() {
            const contact = JSON.parse(localStorage.getItem('contactInfo'));
            document.getElementById('phone').value = contact.phone;
            document.getElementById('email').value = contact.email;
            document.getElementById('instagram').value = contact.instagram;
            document.getElementById('whatsapp').value = contact.whatsapp;
        }
        
        document.getElementById('contactForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const contact = {
                phone: document.getElementById('phone').value,
                email: document.getElementById('email').value,
                instagram: document.getElementById('instagram').value,
                whatsapp: document.getElementById('whatsapp').value
            };
            
            localStorage.setItem('contactInfo', JSON.stringify(contact));
            
            showMessage('contactMessage', 'Contact information updated successfully!', 'success');
        });
        
        // Services Management
        function loadServices() {
            const services = JSON.parse(localStorage.getItem('services'));
            const container = document.getElementById('servicesContainer');
            container.innerHTML = '';
            
            services.forEach((service, index) => {
                container.innerHTML += `
                    <div class="mb-4 pb-4" style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                        <h5 class="mb-3">Service ${index + 1}</h5>
                        <div class="row">
                            <div class="col-md-6">
                                <label class="form-label">Title</label>
                                <input type="text" class="form-control" id="serviceTitle${index}" value="${service.title}">
                            </div>
                            <div class="col-12">
                                <label class="form-label">Description</label>
                                <textarea class="form-control" id="serviceDesc${index}" rows="3">${service.description}</textarea>
                            </div>
                        </div>
                    </div>
                `;
            });
        }
        
        document.getElementById('servicesForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const services = JSON.parse(localStorage.getItem('services'));
            services.forEach((service, index) => {
                service.title = document.getElementById(`serviceTitle${index}`).value;
                service.description = document.getElementById(`serviceDesc${index}`).value;
            });
            
            localStorage.setItem('services', JSON.stringify(services));
            
            showMessage('servicesMessage', 'Services updated successfully!', 'success');
        });
        
        // Fleet Management
        function loadFleet() {
            const fleet = JSON.parse(localStorage.getItem('fleet'));
            const container = document.getElementById('fleetContainer');
            container.innerHTML = '';
            
            fleet.forEach((vehicle, index) => {
                container.innerHTML += `
                    <div class="mb-4 pb-4" style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                        <h5 class="mb-3">Vehicle ${index + 1}</h5>
                        <div class="row">
                            <div class="col-md-4">
                                <label class="form-label">Name</label>
                                <input type="text" class="form-control" id="fleetName${index}" value="${vehicle.name}">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">Type</label>
                                <input type="text" class="form-control" id="fleetType${index}" value="${vehicle.type}">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">Price</label>
                                <input type="text" class="form-control" id="fleetPrice${index}" value="${vehicle.price}">
                            </div>
                        </div>
                    </div>
                `;
            });
        }
        
        document.getElementById('fleetForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const fleet = JSON.parse(localStorage.getItem('fleet'));
            fleet.forEach((vehicle, index) => {
                vehicle.name = document.getElementById(`fleetName${index}`).value;
                vehicle.type = document.getElementById(`fleetType${index}`).value;
                vehicle.price = document.getElementById(`fleetPrice${index}`).value;
            });
            
            localStorage.setItem('fleet', JSON.stringify(fleet));
            
            showMessage('fleetMessage', 'Fleet information updated successfully!', 'success');
        });
        
        // Users Management
        function loadUsers() {
            const admins = JSON.parse(localStorage.getItem('admins') || '[]');
            const tbody = document.getElementById('usersTable');
            tbody.innerHTML = '';
            
            admins.forEach((admin, index) => {
                const isCurrentUser = admin.username === currentAdmin.username;
                const canDelete = admins.length > 1 && !isCurrentUser;
                
                tbody.innerHTML += `
                    <tr>
                        <td>${admin.username}</td>
                        <td>
                            <span class="badge ${admin.role === 'super-admin' ? 'badge-super' : 'badge-admin'}">
                                ${admin.role}
                            </span>
                        </td>
                        <td>
                            ${canDelete ? `<button class="btn btn-danger btn-sm" onclick="deleteUser(${index})">Delete</button>` : '<span style="opacity: 0.5;">Cannot Delete</span>'}
                        </td>
                    </tr>
                `;
            });
        }
        
        function showAddUserForm() {
            document.getElementById('addUserForm').style.display = 'block';
        }
        
        function hideAddUserForm() {
            document.getElementById('addUserForm').style.display = 'none';
            document.getElementById('newUserForm').reset();
        }
        
        document.getElementById('newUserForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('newUsername').value;
            const password = document.getElementById('newPassword').value;
            const role = document.getElementById('newRole').value;
            
            let admins = JSON.parse(localStorage.getItem('admins') || '[]');
            
            // Check if username exists
            if (admins.find(a => a.username === username)) {
                showMessage('usersMessage', 'Username already exists!', 'danger');
                return;
            }
            
            admins.push({ username, password, role });
            localStorage.setItem('admins', JSON.stringify(admins));
            
            hideAddUserForm();
            loadUsers();
            document.getElementById('statAdmins').textContent = admins.length;
            
            showMessage('usersMessage', 'Admin user added successfully!', 'success');
        });
        
        function deleteUser(index) {
            if (!confirm('Are you sure you want to delete this admin user?')) {
                return;
            }
            
            let admins = JSON.parse(localStorage.getItem('admins') || '[]');
            admins.splice(index, 1);
            localStorage.setItem('admins', JSON.stringify(admins));
            
            loadUsers();
            document.getElementById('statAdmins').textContent = admins.length;
            
            showMessage('usersMessage', 'Admin user deleted successfully!', 'success');
        }
        
        // Utility Functions
        function showMessage(elementId, message, type) {
            const element = document.getElementById(elementId);
            element.innerHTML = `<div class="alert alert-${type}">${message}</div>`;
            
            setTimeout(() => {
                element.innerHTML = '';
            }, 3000);
        }
        
        function logout() {
            localStorage.removeItem('adminLoggedIn');
            localStorage.removeItem('currentAdmin');
            window.location.href = 'admin-login.html';
        }
    </script>
</body>
</html>
